%script{:src => "http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAzr2EBOXUKnm_jVnk0OJI7xSosDVG8KKPE1-m51RBrvYughuyMxQ-i1QfUnH94QxWIa6N4U6MouMmBA", :type => "text/javascript"}
%script{:type => "text/javascript"}
  function initialize() {
  if (GBrowserIsCompatible()) {
  var map = new GMap2(document.getElementById("map_canvas"));
  geocoder = new GClientGeocoder();
  = "geocoder.getLatLng('#{@center_zip_code}', function(point){ map.setCenter(point, 12); });"
  map.setCenter(new GLatLng(37.4419, -122.1419), 1);
  var greenIcon = new GIcon(G_DEFAULT_ICON)
  greenIcon.image = "http://www.google.com/intl/en_us/mapfiles/ms/micons/green-dot.png"
  greenMarkerOptions = { icon: greenIcon };

  - current_community.users.select{ |u| u.latitude.present? and u.longitude.present? }.each do |user|
    = "map.addOverlay(new GMarker(new GLatLng(#{user.latitude}, #{user.longitude}), greenMarkerOptions));"
  }
  }
  $(document).ready(initialize);
#map_canvas{:style => "width: 800px; height: 700px"}


